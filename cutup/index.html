<html>
    <head>
        <title>Cut Up v0.1</title>
    </head>
    <style>
        #text, #submit, #output {
            display: block;
            margin: 0 auto;
            margin-top: 20px;
            margin-bottom: 20px;
        }
        #output {
            white-space: pre-line;
            width: 500px;
        }

        #settings {
            margin: 0 auto;
            display: block;
            width: 300px;
            text-align: center;
        }

        #header {
            text-align: center;
        }


    </style>
    <body>
        <div id="header">
            <h2>Cut Up v0.1</h2>
            <a href="https://www.openculture.com/2019/05/how-david-bowie-used-william-s-burroughs-cut-up-method-to-write-his-unforgettable-lyrics.html">About the Cut Up Method used by David Bowie and others</a>
            <a href="https://github.com/ridoy/cutup">Github</a>
        </div>
        <textarea placeholder="Enter anything here and click Randomize." cols=100 rows=20 id="text"></textarea>
        <div id="settings">
            <label><input id="remove-empty-lines" type="checkbox" checked> Remove empty lines?</label>
        </div>
        <button id="submit">Randomize!</button>
        <p id="output"></p>
    </body>
    <script>
        const inputElementId = "text";
        const submitButtonId  = "submit";
        const outputElementId = "output";
        const removeEmptyCheckboxId = "remove-empty-lines";

        const inputElement = document.getElementById(inputElementId);
        const submitButton = document.getElementById(submitButtonId);
        const outputElement = document.getElementById(outputElementId);
        const removeEmptyCheckbox = document.getElementById(removeEmptyCheckboxId);

        let removeEmptyLines = true;
        let numShuffles = 10000;

        submitButton.addEventListener("click", () => {
                    let input = inputElement.value;
                    outputElement.textContent = randomize(input);
                });

        removeEmptyCheckbox.addEventListener("change", (e) => {
                    removeEmptyLines = (e.target.checked) ? true : false;
                });

        const randomize = (text) => {
            let splitText = text.split("\n");
            if (removeEmptyLines) {
                splitText = splitText.filter((line) => line !== "");
            }
            for (let i = 0; i < numShuffles; i++) {
                let first = Math.floor(Math.random() * splitText.length);
                let second = Math.floor(Math.random() * splitText.length);
                let temp = splitText[first];
                splitText[first] = splitText[second];
                splitText[second] = temp;;
            }
            return splitText.join('\n');
        }
    </script>
</html>
